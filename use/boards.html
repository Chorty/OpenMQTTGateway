<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Boards | OpenMQTTGateway v1.4.0</title>
    <meta name="generator" content="VuePress 1.9.8">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="icon" href="/img/Openmqttgateway_logo_mini.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
    <script type="module" src="https://unpkg.com/esp-web-tools@3.4.2/dist/web/install-button.js?module"></script>
    <meta name="description" content="One gateway, many technologies: MQTT gateway for ESP8266, ESP32, Sonoff RF Bridge or Arduino with bidirectional 433mhz/315mhz/868mhz, Infrared communications, BLE, beacons detection, mi flora / mi jia / LYWSD02/ Mi Scale compatibility, SMS &amp; LORA.">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/favicon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.7f8e66f6.css" as="style"><link rel="preload" href="/assets/js/app.1e7f2518.js" as="script"><link rel="preload" href="/assets/js/2.367b4028.js" as="script"><link rel="preload" href="/assets/js/22.93a18bcd.js" as="script"><link rel="prefetch" href="/assets/js/10.9f6f9879.js"><link rel="prefetch" href="/assets/js/100.7578cb76.js"><link rel="prefetch" href="/assets/js/101.7a9d7cfe.js"><link rel="prefetch" href="/assets/js/102.8b2bea8d.js"><link rel="prefetch" href="/assets/js/103.ac737eda.js"><link rel="prefetch" href="/assets/js/104.9d1f423b.js"><link rel="prefetch" href="/assets/js/105.082681a3.js"><link rel="prefetch" href="/assets/js/106.cad2b8e1.js"><link rel="prefetch" href="/assets/js/107.d21878a1.js"><link rel="prefetch" href="/assets/js/108.6e737fc3.js"><link rel="prefetch" href="/assets/js/109.9e224e67.js"><link rel="prefetch" href="/assets/js/11.55e33804.js"><link rel="prefetch" href="/assets/js/110.198b0303.js"><link rel="prefetch" href="/assets/js/111.95d01b58.js"><link rel="prefetch" href="/assets/js/12.e93c2db3.js"><link rel="prefetch" href="/assets/js/13.0922abdd.js"><link rel="prefetch" href="/assets/js/14.58ef0a18.js"><link rel="prefetch" href="/assets/js/15.7fd0b1a1.js"><link rel="prefetch" href="/assets/js/16.5b442ebf.js"><link rel="prefetch" href="/assets/js/17.c624da4a.js"><link rel="prefetch" href="/assets/js/18.efdbcdd2.js"><link rel="prefetch" href="/assets/js/19.ea0e2bfd.js"><link rel="prefetch" href="/assets/js/20.4a50834a.js"><link rel="prefetch" href="/assets/js/21.0799efb1.js"><link rel="prefetch" href="/assets/js/23.751b1a54.js"><link rel="prefetch" href="/assets/js/24.e2487025.js"><link rel="prefetch" href="/assets/js/25.d94c6842.js"><link rel="prefetch" href="/assets/js/26.9184179e.js"><link rel="prefetch" href="/assets/js/27.48199ef9.js"><link rel="prefetch" href="/assets/js/28.3b8c2ab5.js"><link rel="prefetch" href="/assets/js/29.c032a581.js"><link rel="prefetch" href="/assets/js/3.6ee09ba9.js"><link rel="prefetch" href="/assets/js/30.09d6eb84.js"><link rel="prefetch" href="/assets/js/31.f19efe76.js"><link rel="prefetch" href="/assets/js/32.d13ce2e8.js"><link rel="prefetch" href="/assets/js/33.8cb74fab.js"><link rel="prefetch" href="/assets/js/34.c7dc361d.js"><link rel="prefetch" href="/assets/js/35.6ab90651.js"><link rel="prefetch" href="/assets/js/36.456fe298.js"><link rel="prefetch" href="/assets/js/37.59af03ba.js"><link rel="prefetch" href="/assets/js/38.c4ed8e95.js"><link rel="prefetch" href="/assets/js/39.a96860b1.js"><link rel="prefetch" href="/assets/js/4.de4c5787.js"><link rel="prefetch" href="/assets/js/40.dbb8e09d.js"><link rel="prefetch" href="/assets/js/41.23bb0c33.js"><link rel="prefetch" href="/assets/js/42.f3a04242.js"><link rel="prefetch" href="/assets/js/43.423f4d34.js"><link rel="prefetch" href="/assets/js/44.cdd2e04b.js"><link rel="prefetch" href="/assets/js/45.aedb0458.js"><link rel="prefetch" href="/assets/js/46.db5fcb32.js"><link rel="prefetch" href="/assets/js/47.76158147.js"><link rel="prefetch" href="/assets/js/48.c3746e57.js"><link rel="prefetch" href="/assets/js/49.24a2e4c6.js"><link rel="prefetch" href="/assets/js/5.b11ada9a.js"><link rel="prefetch" href="/assets/js/50.06c6ec1a.js"><link rel="prefetch" href="/assets/js/51.e277cf0b.js"><link rel="prefetch" href="/assets/js/52.2282e443.js"><link rel="prefetch" href="/assets/js/53.80a649b5.js"><link rel="prefetch" href="/assets/js/54.6e3306a9.js"><link rel="prefetch" href="/assets/js/55.e8dffff3.js"><link rel="prefetch" href="/assets/js/56.68eb4020.js"><link rel="prefetch" href="/assets/js/57.b5d6af9e.js"><link rel="prefetch" href="/assets/js/58.ebe93cbc.js"><link rel="prefetch" href="/assets/js/59.ba0dfaa3.js"><link rel="prefetch" href="/assets/js/6.240a123d.js"><link rel="prefetch" href="/assets/js/60.84d580fd.js"><link rel="prefetch" href="/assets/js/61.8694c0a7.js"><link rel="prefetch" href="/assets/js/62.1a74aac0.js"><link rel="prefetch" href="/assets/js/63.b4d94e4a.js"><link rel="prefetch" href="/assets/js/64.1f17693a.js"><link rel="prefetch" href="/assets/js/65.217ab04f.js"><link rel="prefetch" href="/assets/js/66.42dc99f1.js"><link rel="prefetch" href="/assets/js/67.907fad45.js"><link rel="prefetch" href="/assets/js/68.bad8013c.js"><link rel="prefetch" href="/assets/js/69.17a657cd.js"><link rel="prefetch" href="/assets/js/7.710f293a.js"><link rel="prefetch" href="/assets/js/70.57c9a164.js"><link rel="prefetch" href="/assets/js/71.9954a436.js"><link rel="prefetch" href="/assets/js/72.2a9583cf.js"><link rel="prefetch" href="/assets/js/73.fbeb6851.js"><link rel="prefetch" href="/assets/js/74.fed8085d.js"><link rel="prefetch" href="/assets/js/75.22c97b5c.js"><link rel="prefetch" href="/assets/js/76.3a412c19.js"><link rel="prefetch" href="/assets/js/77.192f0704.js"><link rel="prefetch" href="/assets/js/78.77923912.js"><link rel="prefetch" href="/assets/js/79.3b0e4046.js"><link rel="prefetch" href="/assets/js/8.f7c945f8.js"><link rel="prefetch" href="/assets/js/80.c3f6c0f5.js"><link rel="prefetch" href="/assets/js/81.cbcd2c17.js"><link rel="prefetch" href="/assets/js/82.3c5c8e0b.js"><link rel="prefetch" href="/assets/js/83.2a97a8ac.js"><link rel="prefetch" href="/assets/js/84.a8b61450.js"><link rel="prefetch" href="/assets/js/85.d68f622c.js"><link rel="prefetch" href="/assets/js/86.6e1440a9.js"><link rel="prefetch" href="/assets/js/87.ba2a55be.js"><link rel="prefetch" href="/assets/js/88.cfc65ad5.js"><link rel="prefetch" href="/assets/js/89.9d19a10f.js"><link rel="prefetch" href="/assets/js/9.91812ffd.js"><link rel="prefetch" href="/assets/js/90.2e22a2cb.js"><link rel="prefetch" href="/assets/js/91.cbc1f84e.js"><link rel="prefetch" href="/assets/js/92.d41eb0f1.js"><link rel="prefetch" href="/assets/js/93.8cc5d95a.js"><link rel="prefetch" href="/assets/js/94.afa26d4e.js"><link rel="prefetch" href="/assets/js/95.3f3842e4.js"><link rel="prefetch" href="/assets/js/96.7b093827.js"><link rel="prefetch" href="/assets/js/97.72cfad62.js"><link rel="prefetch" href="/assets/js/98.e72232ec.js"><link rel="prefetch" href="/assets/js/99.beb79d8c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7f8e66f6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">OpenMQTTGateway v1.4.0</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://shop.theengs.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Shop🆕
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://1technophile.blogspot.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/" class="nav-link">
  Docs
</a></div><div class="nav-item"><a href="https://community.openmqttgateway.com" target="_self" class="nav-link external">
  Community
  <!----></a></div><div class="nav-item"><a href="https://compatible.openmqttgateway.com/index.php/devices" target="_self" class="nav-link external">
  Devices
  <!----></a></div><div class="nav-item"><a href="/upload/web-install.html" class="nav-link">
  Upload
</a></div><div class="nav-item"><a href="https://app.theengs.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Theengs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/1technophile/OpenMQTTGateway" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://shop.theengs.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Shop🆕
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://1technophile.blogspot.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/" class="nav-link">
  Docs
</a></div><div class="nav-item"><a href="https://community.openmqttgateway.com" target="_self" class="nav-link external">
  Community
  <!----></a></div><div class="nav-item"><a href="https://compatible.openmqttgateway.com/index.php/devices" target="_self" class="nav-link external">
  Devices
  <!----></a></div><div class="nav-item"><a href="/upload/web-install.html" class="nav-link">
  Upload
</a></div><div class="nav-item"><a href="https://app.theengs.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Theengs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/1technophile/OpenMQTTGateway" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">0 - What is it for 🏠</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>1 - Prerequisites🧭</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>2 - Set it up 🔨</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>3 - Upload ➡️</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>4 - Use ✈️</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/use/rf.html" class="sidebar-link">RF gateways  (433mhz/315mhz)</a></li><li><a href="/use/ble.html" class="sidebar-link">BLE gateway</a></li><li><a href="/use/ir.html" class="sidebar-link">IR gateway</a></li><li><a href="/use/lora.html" class="sidebar-link">LORA gateway</a></li><li><a href="/use/gsm.html" class="sidebar-link">GSM 2G gateway</a></li><li><a href="/use/rs232.html" class="sidebar-link">RS232 gateway</a></li><li><a href="/use/rfm69.html" class="sidebar-link">RFM69 gateway</a></li><li><a href="/use/sensors.html" class="sidebar-link">Sensors</a></li><li><a href="/use/actuators.html" class="sidebar-link">Actuators</a></li><li><a href="/use/boards.html" aria-current="page" class="active sidebar-link">Boards</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/use/boards.html#esp" class="sidebar-link">ESP</a></li><li class="sidebar-sub-header"><a href="/use/boards.html#m5stickc-m5stickc-plus-or-m5stack" class="sidebar-link">M5StickC, M5StickC Plus or M5Stack</a></li><li class="sidebar-sub-header"><a href="/use/boards.html#ssd1306-display-boards-heltec-sx127x-433mhz-boards-and-lilygo®-lora32-v2-1-1-6-1-433-mhz" class="sidebar-link">SSD1306 Display boards ( Heltec SX127X 433Mhz boards and LILYGO® LoRa32 V2.1_1.6.1 433 Mhz )</a></li></ul></li><li><a href="/use/gateway.html" class="sidebar-link">System commands (ESP only)</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>5 - Integrate 🎉</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>6 - Participate 💻</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="boards"><a href="#boards" class="header-anchor">#</a> Boards</h1> <h2 id="esp"><a href="#esp" class="header-anchor">#</a> ESP</h2> <h3 id="erasing-the-flash"><a href="#erasing-the-flash" class="header-anchor">#</a> Erasing the flash</h3> <p>So as to erase the flash memory on ESP boards you may do a long press to TRIGGER_GPIO button or connect the pin TRIGGER_GPIO to the ground during several seconds.</p> <p>On M5Stack boards you may do a long press to these buttons in low power mode 0 (see below how to go to low power mode 0):</p> <ul><li>Button B on M5StickC and M5StickC Plus (GPIO 37)</li> <li>Button C on M5Stack (GPIO 37)</li> <li>Button lateral on M5stick (GPIO 35)</li></ul> <p>You can also do a long press when powering the board to reset it, this press must be done during the first 5 seconds after the start.</p> <h3 id="low-power-mode-for-esp32"><a href="#low-power-mode-for-esp32" class="header-anchor">#</a> Low power mode for ESP32</h3> <p>OpenMQTTGateway support a low power mode for ESP32, this mode is available per default on boards with batteries. The other boards needs to have the macro <code>DEFAULT_LOW_POWER_MODE</code> defined at 0, 1 or 2 to use it. More information about the modes is available into User_config.h.</p> <p>When available this mode can be set by MQTT:</p> <ul><li>Normal mode (per default)</li></ul> <p><code>mosquitto_pub -t &quot;home/OpenMQTTGateway/commands/MQTTtoBT/config&quot; -m '{&quot;lowpowermode&quot;:0}'</code></p> <ul><li>Low Power mode</li></ul> <p><code>mosquitto_pub -t &quot;home/OpenMQTTGateway/commands/MQTTtoBT/config&quot; -m '{&quot;lowpowermode&quot;:2}'</code></p> <p>The interval between the ESP32 wake up is defined at build time by the macro <code>TimeBtwRead</code>, a change of the <code>interval</code> through MQTT will not impact the time between wake up.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>When coming back from mode 2 to mode 0 you may publish the command with a retain flag so as to enable the gateway to retrieve it when reconnecting.
A low power mode switch is automatically created by discovery with Home Assistant, you may experience a delay between the command and the state update due to the fact that the update will be revceived and acknowledged when the device woke up.
In low power mode you should use ESPWifiManualSetup so as to rely on the credentials entered into User_config.h.
So as to do that uncomment the line below in User_config.h</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//#  define ESPWifiManualSetup true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>For platformio and example of environment is available into <a href="https://github.com/1technophile/OpenMQTTGateway/blob/development/prod_env.ini.example" target="_blank" rel="noopener noreferrer">prod_env.ini.example<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>If you change the default low power mode in config_BT.h to 2 and your credential are not set or not correct, the ESP32 will not connect to the broker and the only way to change the low power mode will be a new erase/upload.</p></div> <h2 id="m5stickc-m5stickc-plus-or-m5stack"><a href="#m5stickc-m5stickc-plus-or-m5stack" class="header-anchor">#</a> M5StickC, M5StickC Plus or M5Stack</h2> <h3 id="behaviour"><a href="#behaviour" class="header-anchor">#</a> Behaviour</h3> <p>If the connection of the board to WIFI and MQTT is successful you will see the logo with text like below:</p> <p><img src="/assets/img/OpenMQTTgateway_M5_Stack_Board_Display_Text.b2457906.png" alt="boards"></p> <p>The same behaviour apply to M5StickC and M5StickC Plus</p> <p><img src="/assets/img/OpenMQTTgateway_M5_StickC_Board_Display_Text.7c5c1d9b.png" alt="boards"></p> <h3 id="setting-the-log-output"><a href="#setting-the-log-output" class="header-anchor">#</a> Setting the log output</h3> <p>Per default the log of the M5 boards is going to the LCD display with Errors and Warnings only, if you want to change the output at build time you can do it in <a href="https://github.com/1technophile/OpenMQTTGateway/blob/development/main/config_M5.h" target="_blank" rel="noopener noreferrer">config_M5.h<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>You can also change it by MQTT. For example if you want to set to LCD</p> <p><code>mosquitto_pub -t home/OpenMQTTGateway/commands/MQTTtoM5/config -m '{&quot;log-display&quot;:true}'</code></p> <p>you can also revert it to the serial monitor:</p> <p><code>mosquitto_pub -t home/OpenMQTTGateway/commands/MQTTtoM5/config -m '{&quot;log-display&quot;:false}'</code></p> <h3 id="low-power-mode-for-m5-boards"><a href="#low-power-mode-for-m5-boards" class="header-anchor">#</a> Low power mode for M5 boards</h3> <p>OpenMQTTGateway support a low power mode for ESP32, this mode can be set by MQTT or a button on M5 boards:</p> <ul><li>Normal mode (per default), screen ON</li></ul> <p><code>mosquitto_pub -t &quot;home/OpenMQTTGateway/commands/MQTTtoBT/config&quot; -m '{&quot;lowpowermode&quot;:0}'</code></p> <ul><li>Low Power mode, screen ON when processing only</li></ul> <p><code>mosquitto_pub -t &quot;home/OpenMQTTGateway/commands/MQTTtoBT/config&quot; -m '{&quot;lowpowermode&quot;:1}'</code></p> <ul><li>Low Power mode, screen OFF, LED ON when processing on M5StickC or M5stickC Plus</li></ul> <p><code>mosquitto_pub -t &quot;home/OpenMQTTGateway/commands/MQTTtoBT/config&quot; -m '{&quot;lowpowermode&quot;:2}'</code></p> <p>The low power mode can be changed also with a push to button B when the board is processing (top button on M5stickC, M5stickC Plus and middle button of M5stack).
If you are already in low power mode 1 or 2 with M5Stack you can wake up the board by pressing the red button.</p> <h2 id="ssd1306-display-boards-heltec-sx127x-433mhz-boards-and-lilygo®-lora32-v2-1-1-6-1-433-mhz"><a href="#ssd1306-display-boards-heltec-sx127x-433mhz-boards-and-lilygo®-lora32-v2-1-1-6-1-433-mhz" class="header-anchor">#</a> SSD1306 Display boards ( Heltec SX127X 433Mhz boards and LILYGO® LoRa32 V2.1_1.6.1 433 Mhz )</h2> <p>Several options are available for the display of information on the SSD1306 Display.  These options include display of the OMG logo and setup messages, redirecting of the log output to the display, and display of various module messages on the display.  These options are exclusive to each other, and when a different option is enabled, the current option is disabled.</p> <h3 id="setting-the-log-output-2"><a href="#setting-the-log-output-2" class="header-anchor">#</a> Setting the log output</h3> <p>The display of serial log messages to the display can be enabled via compiler directive <code>-DLOG_TO_LCD=true</code> or via MQTT commands.</p> <p>For example if you want to set the serial log to LCD</p> <p><code>mosquitto_pub -t home/OpenMQTTGateway/commands/MQTTtoSSD1306 -m '{&quot;log-lcd&quot;:true}'</code></p> <p>you can also revert it back to the serial monitor:</p> <p><code>mosquitto_pub -t home/OpenMQTTGateway/commands/MQTTtoSSD1306 -m '{&quot;log-lcd&quot;:false}'</code></p> <p>The log level of the messages displayed is Errors and Warnings, and this can only be changed via the compiler directive <code>-DLOG_LEVEL_LCD=LOG_LEVEL_NOTICE</code>.</p> <h3 id="displaying-module-json-messages-default"><a href="#displaying-module-json-messages-default" class="header-anchor">#</a> Displaying Module json messages ( default )</h3> <p>The display of messages from various modules is also supported.  Currently supported modules include <code>ZgatewayRTL_433</code> and <code>ZsensorBME280</code>.</p> <p>This can be enabled with the compiler directive <code>-DJSON_TO_LCD=true</code>.</p> <p>You can also change it by MQTT. For example if you want to display module json messages:</p> <p><code>mosquitto_pub -t home/OpenMQTTGateway/commands/MQTTtoSSD1306 -m '{&quot;json-lcd&quot;:true}'</code></p> <p>And to disable the display of module json messages:</p> <p><code>mosquitto_pub -t home/OpenMQTTGateway/commands/MQTTtoSSD1306 -m '{&quot;display-json&quot;:false}'</code></p> <h3 id="units-for-display-metric-or-imperial"><a href="#units-for-display-metric-or-imperial" class="header-anchor">#</a> Units for display, Metric or Imperial</h3> <p>By default the display uses metric units, and this can be changed either by compiler directive or mqtt command.</p> <p>The compiler directive is <code>-DDISPLAY_METRIC=true</code></p> <p>The mqtt command to change the units is:</p> <p><code>mosquitto_pub -t home/OpenMQTTGateway/commands/MQTTtoSSD1306 -m '{&quot;display-metric&quot;:false}'</code></p> <p>Please note that it may take several seconds/display updates for the units to change.  This is due to the queueing of messages for display.</p> <h3 id="flip-display-180-degrees"><a href="#flip-display-180-degrees" class="header-anchor">#</a> Flip Display 180 degrees</h3> <p>This allows you to rotate the display 180 degrees.  Can be set at compile time or during use, defaults to true.</p> <p>The compiler directive is <code>-DDISPLAY_FLIP=false</code></p> <p>The mqtt command to change display orientation is:</p> <p><code>mosquitto_pub -t home/OpenMQTTGateway/commands/MQTTtoSSD1306 -m '{&quot;display-flip&quot;:false}'</code></p> <p>Please note that it may take several seconds/display updates for the display to change.  This is due to the queueing of messages for display.</p> <h3 id="display-openmqttgateway-logo-when-idle"><a href="#display-openmqttgateway-logo-when-idle" class="header-anchor">#</a> Display OpenMQTTGateway Logo when Idle</h3> <p>When this option is enabled the OLED display will show the OpenMQTTGateway Logo when it is idle.  Defaults to false</p> <p>The compiler directive is <code>-DDISPLAY_IDLE_LOGO=true</code></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/1technophile/OpenMQTTGateway/edit/development/docs/use/boards.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2/13/2023, 4:18:18 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/use/actuators.html" class="prev">
        Actuators
      </a></span> <span class="next"><a href="/use/gateway.html">
        System commands (ESP only)
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.1e7f2518.js" defer></script><script src="/assets/js/2.367b4028.js" defer></script><script src="/assets/js/22.93a18bcd.js" defer></script>
  </body>
</html>
